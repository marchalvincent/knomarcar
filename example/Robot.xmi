<?xml version="1.0" encoding="ASCII"?>
<metamodel:Robot
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:metamodel="http://metamodel/1.0"
    xsi:schemaLocation="http://metamodel/1.0 ../model/metaModel.ecore"
    name="e-puck">
  <behaviours
      name="home">
    <stateMachine>
      <states
          actions="//@actions.0"
          name="forward">
        <transitions
            dest="//@behaviours.0/@stateMachine/@states.2"
            name="lightOnLeft">
          <conditions
              xsi:type="metamodel:MoreThan"
              operandLeft="//@sensors.5/@value"
              operandRight="//@sensors.4/@value"/>
        </transitions>
        <transitions
            dest="//@behaviours.0/@stateMachine/@states.1"
            name="lightOnRight">
          <conditions
              xsi:type="metamodel:MoreThan"
              operandLeft="//@sensors.4/@value"
              operandRight="//@sensors.5/@value"/>
        </transitions>
        <transitions
            dest="//@behaviours.0/@stateMachine/@states.3"
            name="lightReached">
          <conditions
              xsi:type="metamodel:And">
            <operandRight
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.4/@value"
                operandRight="//@behaviours.0/@stateMachine/@states.0/@value"/>
            <operandLeft
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.5/@value"
                operandRight="//@behaviours.0/@stateMachine/@states.0/@value"/>
          </conditions>
        </transitions>
        <value
            name="lightReachedValue">
          <value
              xsi:type="metamodel:IntVal"
              value="10"/>
        </value>
      </states>
      <states
          actions="//@actions.2"
          name="turnRight">
        <transitions
            dest="//@behaviours.0/@stateMachine/@states.0"
            name="lightInFrontOf">
          <conditions
              xsi:type="metamodel:Equal"
              operandLeft="//@sensors.4/@value"
              operandRight="//@sensors.5/@value"/>
        </transitions>
      </states>
      <states
          actions="//@actions.1"
          name="turnLeft">
        <transitions
            dest="//@behaviours.0/@stateMachine/@states.0"
            name="lightInFrontOf">
          <conditions
              xsi:type="metamodel:Equal"
              operandLeft="//@sensors.4/@value"
              operandRight="//@sensors.5/@value"/>
        </transitions>
      </states>
      <states
          actions="//@actions.3"
          name="stop"/>
    </stateMachine>
  </behaviours>
  <behaviours
      name="escape"
      priority="1">
    <stateMachine>
      <states
          name="forwardESC">
        <transitions
            dest="//@behaviours.1/@stateMachine/@states.1"
            name="avoidLeft">
          <conditions
              xsi:type="metamodel:And">
            <operandRight
                xsi:type="metamodel:LessThan"
                operandLeft="//@sensors.1/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
            <operandLeft
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.0/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
          </conditions>
        </transitions>
        <transitions
            dest="//@behaviours.1/@stateMachine/@states.2"
            name="avoidRight">
          <conditions
              xsi:type="metamodel:And">
            <operandRight
                xsi:type="metamodel:LessThan"
                operandLeft="//@sensors.0/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
            <operandLeft
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.1/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
          </conditions>
        </transitions>
        <transitions
            dest="//@behaviours.1/@stateMachine/@states.1"
            name="avoidFront">
          <conditions
              xsi:type="metamodel:And">
            <operandRight
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.0/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
            <operandLeft
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.1/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
          </conditions>
        </transitions>
        <value
            name="rangeMax">
          <value
              xsi:type="metamodel:IntVal"
              value="10"/>
        </value>
      </states>
      <states
          actions="//@actions.2"
          name="turnRightESC">
        <transitions
            dest="//@behaviours.1/@stateMachine/@states.0"
            name="goodToGo">
          <conditions
              xsi:type="metamodel:And">
            <operandRight
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.0/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
            <operandLeft
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.1/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
          </conditions>
        </transitions>
      </states>
      <states
          actions="//@actions.1"
          name="turnLeftESC">
        <transitions
            dest="//@behaviours.1/@stateMachine/@states.0"
            name="goodToGo">
          <conditions
              xsi:type="metamodel:And">
            <operandRight
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.1/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
            <operandLeft
                xsi:type="metamodel:MoreThan"
                operandLeft="//@sensors.0/@value"
                operandRight="//@behaviours.1/@stateMachine/@states.0/@value"/>
          </conditions>
        </transitions>
      </states>
    </stateMachine>
  </behaviours>
  <sensors xsi:type="metamodel:DistanceSensor"
      name="FrDsRight"
      sensorName="ds0">
    <value name="FrDsRightVal">
      <value
          xsi:type="metamodel:FloatVal"/>
    </value>
  </sensors>
  <sensors xsi:type="metamodel:DistanceSensor"
      name="FrDsLeft"
      sensorName="ps7">
    <value name="FrDsLeftVal">
      <value
          xsi:type="metamodel:FloatVal"/>
    </value>
  </sensors>
  <sensors xsi:type="metamodel:DistanceSensor"
      name="BhDsRight"
      sensorName="ps3">
    <value name="BhDsRight">
      <value
          xsi:type="metamodel:FloatVal"/>
    </value>
  </sensors>
  <sensors xsi:type="metamodel:DistanceSensor"
      name="BhDsLeft"
      sensorName="ps4">
    <value name="BhDsLeft">
      <value
          xsi:type="metamodel:FloatVal"/>
    </value>
  </sensors>
  <sensors xsi:type="metamodel:LightSensor"
      name="LsRight"
      sensorName="ls1">
    <value name="LsRightVal">
      <value
          xsi:type="metamodel:FloatVal"/>
    </value>
  </sensors>
  <sensors xsi:type="metamodel:LightSensor"
      name="LsLeft"
      sensorName="ls6">
    <value name="LsLeftVal">
      <value
          xsi:type="metamodel:FloatVal"/>
    </value>
  </sensors>
  <actuators
      xsi:type="metamodel:DifferentialWheel"
      name="wheelLeft"
      isLeft="true"/>
  <actuators
      xsi:type="metamodel:DifferentialWheel"
      name="wheelRight"/>
  <actuators
      xsi:type="metamodel:Group"
      name="group"
      wheels="//@actuators.0 //@actuators.1"/>
  <actions xsi:type="metamodel:Forward"
      group="//@actuators.2"
      speed="50"/>
  <actions xsi:type="metamodel:TurnLeft"
      group="//@actuators.2"
      speed="50"/>
  <actions xsi:type="metamodel:TurnRight"
      group="//@actuators.2"
      speed="50"/>
  <actions xsi:type="metamodel:Stopping"
      group="//@actuators.2"/>
</metamodel:Robot>
